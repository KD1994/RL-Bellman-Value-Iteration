<h1 align="center">
  <b>Value Iteration method using Bellman equation</b>
</h1>

<p align="center">
  <a href="https://www.python.org/downloads/release/python-31012/">
    <img src="https://img.shields.io/badge/Python-3.10.12-blue" alt="Python 3.10.12">
  </a>
</p>


# PROBLEM STATEMENT

You are given a 4x4 GridWorld where an agent starts at the top-left corner (state 0) and tries to reach the bottom-right corner (state 15). The agent can move up, down, left or right with equal probability. The rewards are -1 for each move, and the terminal state (bottom-right) has a reward 0. There are no obstacles. Your task is to:

1. initialize V(s) to 0 for all states
2. Iteratively apply the Bellman equation until convergence:
![alt text](<assets/Bellman Equation.png>)
    
3. where P(s'|s, a) is the transition probability (equal for all moves)
4. Use gamma = 1 (no discounting)
5. Stop when maximum change in V(s) across all states is < 1e - 4.


# FINAL VALUE MATRIX AFTER 470 ITERATION

```
[[-59.42367735 -57.42387125 -54.2813141  -51.71012579]
 [-57.42387125 -54.56699476 -49.71029394 -45.13926711]
 [-54.2813141  -49.71029394 -40.85391609 -29.99766609]
 [-51.71012579 -45.13926711 -29.99766609   0.        ]]
```


# LOGS

```
--------- Initial Value Array ----------
[[0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]
---------- Reward for states -----------
[[-1. -1. -1. -1.]
 [-1. -1. -1. -1.]
 [-1. -1. -1. -1.]
 [-1. -1. -1.  0.]]
----- Value Matrix at iteration: 0 -----
| -1.0  | -1.0  | -1.0  | -1.0  |
| -1.0  | -1.0  | -1.0  | -1.0  |
| -1.0  | -1.0  | -1.0  | -1.0  |
| -1.0  | -1.0  | -1.0  | 0.0   |

---- Value Matrix at iteration: 10 -----
| -10.8 | -10.7 | -10.5 | -10.3 |
| -10.7 | -10.5 | -10.0 | -9.41 |
| -10.5 | -10.0 | -8.74 | -6.76 |
| -10.3 | -9.41 | -6.76 | 0.0   |

---- Value Matrix at iteration: 20 -----
| -19.6 | -19.1 | -18.4 | -17.8 |
| -19.1 | -18.4 | -17.2 | -15.9 |
| -18.4 | -17.2 | -14.5 | -11.0 |
| -17.8 | -15.9 | -11.0 | 0.0   |

---- Value Matrix at iteration: 30 -----
| -26.8 | -26.1 | -24.9 | -24.0 |
| -26.1 | -25.0 | -23.1 | -21.2 |
| -24.9 | -23.1 | -19.3 | -14.4 |
| -24.0 | -21.2 | -14.4 | 0.0   |

---- Value Matrix at iteration: 40 -----
| -32.7 | -31.7 | -30.2 | -29.0 |
| -31.7 | -30.3 | -27.9 | -25.5 |
| -30.2 | -27.9 | -23.2 | -17.2 |
| -29.0 | -25.5 | -17.2 | 0.0   |

---- Value Matrix at iteration: 50 -----
| -37.5 | -36.4 | -34.6 | -33.1 |
| -36.4 | -34.7 | -31.8 | -29.1 |
| -34.6 | -31.8 | -26.4 | -19.5 |
| -33.1 | -29.1 | -19.5 | 0.0   |

---- Value Matrix at iteration: 60 -----
| -41.5 | -40.2 | -38.2 | -36.5 |
| -40.2 | -38.3 | -35.1 | -32.0 |
| -38.2 | -35.1 | -29.0 | -21.4 |
| -36.5 | -32.0 | -21.4 | 0.0   |

---- Value Matrix at iteration: 70 -----
| -44.7 | -43.3 | -41.1 | -39.2 |
| -43.3 | -41.3 | -37.7 | -34.4 |
| -41.1 | -37.7 | -31.2 | -23.0 |
| -39.2 | -34.4 | -23.0 | 0.0   |

---- Value Matrix at iteration: 80 -----
| -47.4 | -45.9 | -43.5 | -41.5 |
| -45.9 | -43.7 | -39.9 | -36.3 |
| -43.5 | -39.9 | -32.9 | -24.2 |
| -41.5 | -36.3 | -24.2 | 0.0   |

---- Value Matrix at iteration: 90 -----
| -49.6 | -48.0 | -45.4 | -43.3 |
| -48.0 | -45.6 | -41.7 | -37.9 |
| -45.4 | -41.7 | -34.3 | -25.3 |
| -43.3 | -37.9 | -25.3 | 0.0   |

---- Value Matrix at iteration: 100 ----
| -51.3 | -49.7 | -47.0 | -44.8 |
| -49.7 | -47.2 | -43.1 | -39.2 |
| -47.0 | -43.1 | -35.5 | -26.1 |
| -44.8 | -39.2 | -26.1 | 0.0   |

---- Value Matrix at iteration: 110 ----
| -52.8 | -51.1 | -48.3 | -46.1 |
| -51.1 | -48.6 | -44.3 | -40.3 |
| -48.3 | -44.3 | -36.5 | -26.8 |
| -46.1 | -40.3 | -26.8 | 0.0   |

---- Value Matrix at iteration: 120 ----
| -54.0 | -52.2 | -49.4 | -47.1 |
| -52.2 | -49.6 | -45.3 | -41.1 |
| -49.4 | -45.3 | -37.3 | -27.4 |
| -47.1 | -41.1 | -27.4 | 0.0   |

---- Value Matrix at iteration: 130 ----
| -55.0 | -53.1 | -50.3 | -47.9 |
| -53.1 | -50.5 | -46.1 | -41.9 |
| -50.3 | -46.1 | -37.9 | -27.8 |
| -47.9 | -41.9 | -27.8 | 0.0   |

---- Value Matrix at iteration: 140 ----
| -55.8 | -53.9 | -51.0 | -48.6 |
| -53.9 | -51.3 | -46.7 | -42.4 |
| -51.0 | -46.7 | -38.4 | -28.2 |
| -48.6 | -42.4 | -28.2 | 0.0   |

---- Value Matrix at iteration: 150 ----
| -56.4 | -54.5 | -51.6 | -49.2 |
| -54.5 | -51.8 | -47.3 | -42.9 |
| -51.6 | -47.3 | -38.9 | -28.5 |
| -49.2 | -42.9 | -28.5 | 0.0   |

---- Value Matrix at iteration: 160 ----
| -57.0 | -55.1 | -52.1 | -49.6 |
| -55.1 | -52.3 | -47.7 | -43.3 |
| -52.1 | -47.7 | -39.2 | -28.8 |
| -49.6 | -43.3 | -28.8 | 0.0   |

---- Value Matrix at iteration: 170 ----
| -57.4 | -55.5 | -52.5 | -50.0 |
| -55.5 | -52.7 | -48.0 | -43.6 |
| -52.5 | -48.0 | -39.5 | -29.0 |
| -50.0 | -43.6 | -29.0 | 0.0   |

---- Value Matrix at iteration: 180 ----
| -57.8 | -55.8 | -52.8 | -50.3 |
| -55.8 | -53.1 | -48.3 | -43.9 |
| -52.8 | -48.3 | -39.7 | -29.2 |
| -50.3 | -43.9 | -29.2 | 0.0   |

---- Value Matrix at iteration: 190 ----
| -58.1 | -56.1 | -53.0 | -50.5 |
| -56.1 | -53.3 | -48.6 | -44.1 |
| -53.0 | -48.6 | -39.9 | -29.3 |
| -50.5 | -44.1 | -29.3 | 0.0   |

---- Value Matrix at iteration: 200 ----
| -58.3 | -56.3 | -53.3 | -50.7 |
| -56.3 | -53.5 | -48.8 | -44.3 |
| -53.3 | -48.8 | -40.1 | -29.4 |
| -50.7 | -44.3 | -29.4 | 0.0   |

---- Value Matrix at iteration: 210 ----
| -58.5 | -56.5 | -53.4 | -50.9 |
| -56.5 | -53.7 | -48.9 | -44.4 |
| -53.4 | -48.9 | -40.2 | -29.5 |
| -50.9 | -44.4 | -29.5 | 0.0   |

---- Value Matrix at iteration: 220 ----
| -58.7 | -56.7 | -53.6 | -51.0 |
| -56.7 | -53.9 | -49.1 | -44.6 |
| -53.6 | -49.1 | -40.3 | -29.6 |
| -51.0 | -44.6 | -29.6 | 0.0   |

---- Value Matrix at iteration: 230 ----
| -58.8 | -56.8 | -53.7 | -51.2 |
| -56.8 | -54.0 | -49.2 | -44.7 |
| -53.7 | -49.2 | -40.4 | -29.7 |
| -51.2 | -44.7 | -29.7 | 0.0   |

---- Value Matrix at iteration: 240 ----
| -58.9 | -56.9 | -53.8 | -51.2 |
| -56.9 | -54.1 | -49.3 | -44.7 |
| -53.8 | -49.3 | -40.5 | -29.7 |
| -51.2 | -44.7 | -29.7 | 0.0   |

---- Value Matrix at iteration: 250 ----
| -59.0 | -57.0 | -53.9 | -51.3 |
| -57.0 | -54.2 | -49.3 | -44.8 |
| -53.9 | -49.3 | -40.5 | -29.8 |
| -51.3 | -44.8 | -29.8 | 0.0   |

---- Value Matrix at iteration: 260 ----
| -59.1 | -57.1 | -53.9 | -51.4 |
| -57.1 | -54.2 | -49.4 | -44.9 |
| -53.9 | -49.4 | -40.6 | -29.8 |
| -51.4 | -44.9 | -29.8 | 0.0   |

---- Value Matrix at iteration: 270 ----
| -59.1 | -57.1 | -54.0 | -51.4 |
| -57.1 | -54.3 | -49.4 | -44.9 |
| -54.0 | -49.4 | -40.6 | -29.8 |
| -51.4 | -44.9 | -29.8 | 0.0   |

---- Value Matrix at iteration: 280 ----
| -59.2 | -57.2 | -54.0 | -51.5 |
| -57.2 | -54.3 | -49.5 | -44.9 |
| -54.0 | -49.5 | -40.7 | -29.8 |
| -51.5 | -44.9 | -29.8 | 0.0   |

---- Value Matrix at iteration: 290 ----
| -59.2 | -57.2 | -54.1 | -51.5 |
| -57.2 | -54.4 | -49.5 | -45.0 |
| -54.1 | -49.5 | -40.7 | -29.9 |
| -51.5 | -45.0 | -29.9 | 0.0   |

---- Value Matrix at iteration: 300 ----
| -59.2 | -57.2 | -54.1 | -51.5 |
| -57.2 | -54.4 | -49.5 | -45.0 |
| -54.1 | -49.5 | -40.7 | -29.9 |
| -51.5 | -45.0 | -29.9 | 0.0   |

---- Value Matrix at iteration: 310 ----
| -59.3 | -57.3 | -54.1 | -51.6 |
| -57.3 | -54.4 | -49.6 | -45.0 |
| -54.1 | -49.6 | -40.7 | -29.9 |
| -51.6 | -45.0 | -29.9 | 0.0   |

---- Value Matrix at iteration: 320 ----
| -59.3 | -57.3 | -54.1 | -51.6 |
| -57.3 | -54.4 | -49.6 | -45.0 |
| -54.1 | -49.6 | -40.7 | -29.9 |
| -51.6 | -45.0 | -29.9 | 0.0   |

---- Value Matrix at iteration: 330 ----
| -59.3 | -57.3 | -54.2 | -51.6 |
| -57.3 | -54.4 | -49.6 | -45.0 |
| -54.2 | -49.6 | -40.8 | -29.9 |
| -51.6 | -45.0 | -29.9 | 0.0   |

---- Value Matrix at iteration: 340 ----
| -59.3 | -57.3 | -54.2 | -51.6 |
| -57.3 | -54.5 | -49.6 | -45.0 |
| -54.2 | -49.6 | -40.8 | -29.9 |
| -51.6 | -45.0 | -29.9 | 0.0   |

---- Value Matrix at iteration: 350 ----
| -59.3 | -57.3 | -54.2 | -51.6 |
| -57.3 | -54.5 | -49.6 | -45.1 |
| -54.2 | -49.6 | -40.8 | -29.9 |
| -51.6 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 360 ----
| -59.3 | -57.3 | -54.2 | -51.6 |
| -57.3 | -54.5 | -49.6 | -45.1 |
| -54.2 | -49.6 | -40.8 | -29.9 |
| -51.6 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 370 ----
| -59.3 | -57.3 | -54.2 | -51.6 |
| -57.3 | -54.5 | -49.6 | -45.1 |
| -54.2 | -49.6 | -40.8 | -29.9 |
| -51.6 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 380 ----
| -59.3 | -57.4 | -54.2 | -51.6 |
| -57.4 | -54.5 | -49.6 | -45.1 |
| -54.2 | -49.6 | -40.8 | -29.9 |
| -51.6 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 390 ----
| -59.4 | -57.4 | -54.2 | -51.6 |
| -57.4 | -54.5 | -49.6 | -45.1 |
| -54.2 | -49.6 | -40.8 | -29.9 |
| -51.6 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 400 ----
| -59.4 | -57.4 | -54.2 | -51.6 |
| -57.4 | -54.5 | -49.6 | -45.1 |
| -54.2 | -49.6 | -40.8 | -29.9 |
| -51.6 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 410 ----
| -59.4 | -57.4 | -54.2 | -51.7 |
| -57.4 | -54.5 | -49.7 | -45.1 |
| -54.2 | -49.7 | -40.8 | -29.9 |
| -51.7 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 420 ----
| -59.4 | -57.4 | -54.2 | -51.7 |
| -57.4 | -54.5 | -49.7 | -45.1 |
| -54.2 | -49.7 | -40.8 | -29.9 |
| -51.7 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 430 ----
| -59.4 | -57.4 | -54.2 | -51.7 |
| -57.4 | -54.5 | -49.7 | -45.1 |
| -54.2 | -49.7 | -40.8 | -29.9 |
| -51.7 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 440 ----
| -59.4 | -57.4 | -54.2 | -51.7 |
| -57.4 | -54.5 | -49.7 | -45.1 |
| -54.2 | -49.7 | -40.8 | -29.9 |
| -51.7 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 450 ----
| -59.4 | -57.4 | -54.2 | -51.7 |
| -57.4 | -54.5 | -49.7 | -45.1 |
| -54.2 | -49.7 | -40.8 | -29.9 |
| -51.7 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 460 ----
| -59.4 | -57.4 | -54.2 | -51.7 |
| -57.4 | -54.5 | -49.7 | -45.1 |
| -54.2 | -49.7 | -40.8 | -29.9 |
| -51.7 | -45.1 | -29.9 | 0.0   |

---- Value Matrix at iteration: 470 ----
| -59.4 | -57.4 | -54.2 | -51.7 |
| -57.4 | -54.5 | -49.7 | -45.1 |
| -54.2 | -49.7 | -40.8 | -29.9 |
| -51.7 | -45.1 | -29.9 | 0.0   |

new Value matrix: 
[[-59.42367735 -57.42387125 -54.2813141  -51.71012579]
 [-57.42387125 -54.56699476 -49.71029394 -45.13926711]
 [-54.2813141  -49.71029394 -40.85391609 -29.99766609]
 [-51.71012579 -45.13926711 -29.99766609   0.        ]]

 Generated after 470 iteration
```

